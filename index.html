<!DOCTYPE html>
<html>

    <head>
        
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet"
            integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa"
            crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous" />
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
        <link rel="stylesheet" href="css/login.css" /> 
          
    </head>
    
    <body>
        <div class="body">
            <div class="d-flex flex-row">
                <h1 class="h">Gitam Blood Donation </h1>
                <img class="ig" class="rounded" src="https://i.pinimg.com/564x/5d/94/ff/5d94fff22565a8f3722fc5c0a9a55c45.jpg">
            </div>
            <div class="section bg">
                <div class="container">
                    <div class="row full-height justify-content-center">
                        <div class="col-12 text-center align-self-center py-5">
                            <div class="section pb-5 pt-5 pt-sm-2 text-center">
                                <h6 class="mb-0 he pb-3">
                                    <span>Log In </span>
                                    <span>Sign Up</span>
                                </h6>
                                <input class="checkbox" type="checkbox" id="reg-log" name="reg-log" />
                                <label for="reg-log"></label>
                                <div class="card-3d-wrap mx-auto">
                                    <div class="card-3d-wrapper">
                                        <div class="card-front">
                                            <div class="center-wrap">
                                                <div class="section text-center">
                                                    <div class="wrapper">
                                                        <h4 class="mb-4 pb-3">Log In</h4>
                                                    </div>
                                
                                                        <div class="form-group">
                                                            <input type="email" name="email" class="form-style"
                                                                placeholder="Your Email" id="email" autocomplete="off"
                                                                required>
                            
                                                        </div>
                                                        <div class="form-group mt-2">
                                                            <input type="password" name="password" class="form-style"
                                                                placeholder="Your Password" id="password" autocomplete="off"
                                                                required>
                                                        
                                                        </div>
                                                        <div class="login-box">
                                                            
                                                            <button class="btn btn-primary mt-3" id="login" value="Login" >login</button>
                                                        </div>
                                                    
                                                    <p class="mb-0 mt-4 text-center">Forgot your password?</p>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="card-back">
                                            <div class="center-wrap">
                                                <div class="section text-center">
                                                    <div class="wrapper">
    
                                                        <h4 class="mb-1 pb-3">Sign Up</h4>
                                                    </div>
                                                    <!-- <form id="SignUp"> -->
                                                        <!-- Name -->
                                                        <div class="form-group">
                                                            <input type="text" class="form-style"
                                                                placeholder="Your Full Name" id="username" autocomplete="on"
                                                                required>
                                                            <i class="input-icon uil uil-user"></i>
                                                        </div>
                                                        <!-- Email -->
                                                        <div class="form-group mt-2">
                                                            <input type="email" name="email" class="form-style"
                                                                placeholder="Your Email" id="lemail" autocomplete="on"
                                                                required>
                                                            <i class="input-icon uil uil-at"></i>
                                                        </div>
                                                        <div class="d-flex flex-row">

                                                        <!-- Password -->
                                                        <div class="form-group mt-2">
                                                            <input type="password" name="password" class="form-style"
                                                                placeholder="Create Password" id="lpassword" autocomplete="on"
                                                                required>
                                                            <i class="input-icon uil uil-lock-alt"></i>
                                                        </div>
                                                        <div class="form-group mt-2">
                                                            <input type="password" class="form-style"
                                                                placeholder="Confirm Password" id="repassword"
                                                                autocomplete="on" required>
                                                            <i class="input-icon uil uil-lock-alt"></i>
                                                        </div>
                                                        </div>
                                                        <div class="form-group mt-2">
                                                            <input type="number" name="number" class="form-style"
                                                                placeholder="Phone number" id="ph" autocomplete="on" 
                                                                required>
                                                            <i class="input-icon uil uil-at"></i>
                                                        </div>
                                                        <!-- Age -->
                                                        <div class="form-group mt-2">
                                                            <input type="number" class="form-style" placeholder="Age"
                                                                id="age" autocomplete="off" required>
                                                            <i class="input-icon uil uil-user"></i>
                                                        </div>
                                                        <!-- Blood Group -->
                                                        <div class="form-group mt-2">
                                                            <input class="form-style" placeholder="Blood Group"
                                                                id="bg" list="blood-group" autocomplete="off" required>
                                                            <datalist id="blood-group">
                                                                <option>A+</option>
                                                                <option>A-</option>
                                                                <option>B+</option>
                                                                <option>B-</option>
                                                                <option>O+</option>
                                                                <option>O-</option>
                                                                <option>AB+</option>
                                                                <option>AB-</option>
                                                            </datalist>
                                                        </div>
                                                        <!-- Submit -->
                                                        <div class="login-box">
                                                        <button class="btn btn-primary mt-3" id="signup" value="signup" >signup</button>   
                                                        </div>
                                                    <!-- </form> -->
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </body>
   
<script type="module">
    // TODO: Add SDKs for Firebase products that you want to use
      // https://firebase.google.com/docs/web/setup#available-libraries
    
      // Import the functions you need from the SDKs you need
      import { initializeApp } from "https://www.gstatic.com/firebasejs/9.9.1/firebase-app.js";
      import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.9.1/firebase-analytics.js";
      
      import { getDatabase, set, ref, update } from "https://www.gstatic.com/firebasejs/9.9.1/firebase-database.js";
      import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword} from "https://www.gstatic.com/firebasejs/9.9.1/firebase-auth.js";
      
      // TODO: Add SDKs for Firebase products that you want to use
      // https://firebase.google.com/docs/web/setup#available-libraries
    
      // Your web app's Firebase configuration
      // For Firebase JS SDK v7.20.0 and later, measurementId is optional
      const firebaseConfig = {
        apiKey: "AIzaSyAdO1240EGQj0s2HgEuLulySHlBBzm2fcc",
        authDomain: "g-b-d2.firebaseapp.com",
        databaseURL: "https://g-b-d2-default-rtdb.firebaseio.com",
        projectId: "g-b-d2",
        storageBucket: "g-b-d2.appspot.com",
        messagingSenderId: "852601687667",
        appId: "1:852601687667:web:8444d014a7c78ca0b3a406",
        measurementId: "G-NYJPSEE4PZ"
      };
    
      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const database = getDatabase(app);
      const auth = getAuth();
    
    signup.addEventListener('click',(e) => {
        var username = document.getElementById('username').value;
        var email = document.getElementById('lemail').value;
        var password = document.getElementById('lpassword').value;
        var repassword = document.getElementById('repassword').value;
        var phoneno = document.getElementById('ph').value;
        var bloodgroup = document.getElementById('bg').value;
        var age = document.getElementById('age').value;
        
        function validatePhoneNumber(input_str) {
    var re = /^\(?(\d{3})\)?[- ]?(\d{3})[- ]?(\d{4})$/;

    return re.test(input_str);
}

        if(username!="")
       { 
        if(age>=18)
        {
            if(password===repassword)
            {
                if(validatePhoneNumber(phoneno))
                {
                    if(bloodgroup!="")
                    {
                        createUserWithEmailAndPassword(auth, email, password)
                        .then((userCredential) => {
                            if (bloodgroup=="O+")
                            {
                                const user = userCredential.user;
                                set(ref(database, 'O+users/'+ user.uid ),{
                                email: email,
                                bloodgroup:bloodgroup,
                                age:age,
                                username:username,
                                phoneno:phoneno
                        })
                        alert('user created!');
                        return true
                        }
                        else if (bloodgroup=="O-")
                        {
                            const user = userCredential.user;
                            set(ref(database, 'O-users/' + user.uid),{
                            email: email,
                            bloodgroup:bloodgroup,
                            age:age,
                            phoneno:phoneno,
                            username:username
                    })
                    alert('user created!');
                    }
                    else if (bloodgroup=="A-")
                        {
                            const user = userCredential.user;
                            set(ref(database, 'A-users/' + user.uid),{
                            email: email,
                            bloodgroup:bloodgroup,
                            age:age,phoneno:phoneno,
                            username:username
                    })
                    alert('user created!');
                    }
                    else if (bloodgroup=="B-")
                        {
                            const user = userCredential.user;
                            set(ref(database, 'B-users/' + user.uid),{
                            email: email,
                            bloodgroup:bloodgroup,
                            age:age,phoneno:phoneno,
                            username:username
                    })
                    alert('user created!');
                    }
                    else if (bloodgroup=="AB-")
                        {
                            const user = userCredential.user;
                            set(ref(database, 'AB-users/' + user.uid),{
                            email: email,
                            bloodgroup:bloodgroup,
                            age:age,phoneno:phoneno,
                            username:username
                    })
                    alert('user created!');
                    }
                    else if (bloodgroup=="A+")
                        {
                            const user = userCredential.user;
                            set(ref(database, 'A+users/' + user.uid),{
                            email: email,
                            bloodgroup:bloodgroup,
                            age:age,phoneno:phoneno,
                            username:username
                    })
                    alert('user created!');
                    }
                    else if (bloodgroup=="AB+")
                        {
                            const user = userCredential.user;
                            set(ref(database, 'AB+users/' + user.uid),{
                            email: email,
                            bloodgroup:bloodgroup,
                            age:age,phoneno:phoneno,
                            username:username
                    })
                    alert('user created!');
                    }
                    else if (bloodgroup=="B+")
                        {
                            const user = userCredential.user;
                            set(ref(database, 'B+users/' + user.uid),{
                            email: email,
                            bloodgroup:bloodgroup,
                            age:age,phoneno:phoneno,
                            username:username
                    })
                    alert('user created!');
                    }
                    else{
                        alert("Please select from options")
                    }
                })
            
                .catch((error) => {
                    const errorCode = error.code;
                    const errorMessage = error.message;
                    alert(errorMessage);});
               
                }
                else
                {
                alert("please select blood group")
                
                }
            }
            else
            {
              alert("please enter valid no")
                
            }
        }
        else
        {
          alert("please enter same password")        
        }
    }
    else
    {
      alert("age should be greater than 18")   
    }
  }
  else
  {
    alert("please enter your name")
  }
    
   

 
});
     login.addEventListener('click',(e)=>{
       var email = document.getElementById('email').value;
       var password = document.getElementById('password').value;
       if(email=="GBDadmin@gmail.com"){
        if(password=="savelife"){
            window.location="admin.html"
        }
        else{
            alert('wrong password')
        }

       }

          signInWithEmailAndPassword(auth, email, password)
          .then((userCredential) => {
            // Signed in 
            const user = userCredential.user;
    
            const dt = new Date();
             update(ref(database, 'users/' + user.uid),{
            
            })
    
             alert('User loged in!');
             window.location="homepage.html"
            // ...
          })
          .catch((error) => {
            const errorCode = error.code;
            const errorMessage = error.message;
    
            alert(errorMessage);
      });
    
     });
     </script>
    
        
    
    </html>